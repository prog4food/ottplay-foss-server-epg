# OTT-play FOSS EPG server
Сервер, собирает данные после [ott-play-epg-converter](https://github.com/prog4food/ott-play-epg-converter) в единой точке.


## Конфигурация
Настраивается файлом `config.json`

* `bind` - интерфейс (или unix сокет), на котором будет размещаться сервер, `:3001` занимает все интерфейсы по порту 3001, по умолчанию используется `127.0.0.1:3001`
* `providers` - массив с объектами (`[{},{},{}]`) описывающими источник EPG (`!` помечены обязательные параметры провайдера):
  * !`id` - внутреннее имя источника, используется только для идентификации 
  * !`base_url` или !`base_url_https` - HTTP/HTTPS ссылка на источник (закрывающий `/` обязателен), HTTPS пока с запасом на будущее и потом будет отдаваться клиентам, которые его поддерживают
  * `order_epg` и `order_ico` - "важность" провайдера при автоматическом поиске EPG/значков, чем меньше, тем раньше будет выбран провайдер (по умолчанию `100+порядок в конфиге`)
  * `update_mins` - интервал обновления источника (в минутах, `по умолчанию 6 часов`, планировщик запускается каждые 16 минут)

  Пара слов по порядку провайдеров при автоматическом поиске EPG.\
  Провайдеры выбираются в том порядке, в котором записаны в конфигурационном файле, однако его можно изменять с помощью параметров `order_epg/order_ico`, чем меньше это значение, тем раньше он будет выбран. По-умолчанию записи получают "важность" `100+порядок_в_конфиге`, например 3 провайдера будут иметь важность: 101,102,103. Учитывайте это, когда назначаете приоритеты. Провайдеры с одинаковой "важностью" могут быть отсортированы случайно в рамках своей "важности" :)


### Пример конфига
Полный пример лежит в каталоге `samples/config.json`
```json
{
  "bind":":3001",
  "providers": [
    {"id": "it999", "base_url": "http://ott-epg.prog4food.eu.org/it999/"},
    {"id": "iptvx.one", "order_ico":91, "base_url": "http://ott-epg.prog4food.eu.org/iptvx.one/"},
  ]
}
```
